<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detail Panel Anda</title>
    <link rel="stylesheet" href="css/style.css">
    <style>.spinner { border: 6px solid #f3f3f3; border-top: 6px solid var(--primary-color); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 40px auto 20px; } @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }</style>
</head>
<body>
    <div class="main-container">
        <div class="panel-box">
            <div id="loading"><div class="spinner"></div><p>Sedang membuat server Anda...</p></div>
            <div id="panelData" style="display:none;">
                <h2>Panel Berhasil Dibuat!</h2>
                <p>Simpan detail login Anda dengan baik.</p>
                <div class="data-grid">
                    <div class="data-item"><span>Username</span><strong id="dataUsername"></strong></div>
                    <div class="data-item"><span>Password</span><strong id="dataPassword"></strong></div>
                    <div class="data-item full-width"><span>Email</span><strong id="dataEmail"></strong></div>
                    <div class="data-item"><span>RAM</span><strong id="dataRam"></strong></div>
                    <div class="data-item"><span>Disk</span><strong id="dataDisk"></strong></div>
                    <div class="data-item"><span>CPU</span><strong id="dataCpu"></strong></div>
                    <div class="data-item full-width"><span>Link Login</span><a href="#" id="dataLink" target="_blank"></a></div>
                </div>
                <a href="create-panel.html" class="btn-secondary">Buat Panel Lain</a>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const loadingDiv = document.getElementById('loading');
            const panelDataDiv = document.getElementById('panelData');
            const panelRequestData = JSON.parse(sessionStorage.getItem('panelRequestData'));
            if (!panelRequestData) {
                loadingDiv.innerHTML = "<p>Data permintaan tidak ditemukan. Silakan kembali.</p>"; return;
            }
            async function executePanelCreation() {
                try {
                    const response = await fetch('/api/create-server', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(panelRequestData) });
                    const result = await response.json();
                    if (!response.ok) throw new Error(result.message);
                    loadingDiv.style.display = 'none';
                    document.getElementById('dataUsername').textContent = result.username;
                    document.getElementById('dataPassword').textContent = result.password;
                    document.getElementById('dataEmail').textContent = result.email;
                    document.getElementById('dataRam').textContent = result.ram;
                    document.getElementById('dataDisk').textContent = result.disk;
                    document.getElementById('dataCpu').textContent = result.cpu;
                    const linkElement = document.getElementById('dataLink');
                    linkElement.href = result.domain;
                    linkElement.textContent = result.domain;
                    panelDataDiv.style.display = 'block';
                } catch (error) {
                    loadingDiv.innerHTML = `<p style="color: red; font-weight: bold;">Terjadi Kesalahan:</p><p>${error.message}</p>`;
                }
            }
            executePanelCreation();
        });
    </script>
</body>
</html>